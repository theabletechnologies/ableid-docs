---
id: home
title: Главная
---

## Описание работы с AbleID

**Base URLs:**  
**Дев среда:** [https://ableid-dev-back.theable.tech](https://ableid-dev-back.theable.tech)  
**Продакшн-среда:** [https://faceid-back.theable.tech](https://faceid-back.theable.tech)

API предназначено для инициации, обработки и завершения сессий идентификации с использованием уникальных ключей
`projectId` и `secret`.

> **Для обеспечения безопасности все запросы должны выполняться исключительно с backend-сервера**

> Доступ предоставляется дифференцированно в зависимости от используемых ключей: для каждой среды (Production, Staging,
> Development) применяется отдельный набор ключей, что обеспечивает независимость и изоляцию доступа.

---

## Пример ответа создания сессии

При создании сессии идентификации API возвращает следующий ответ:

```json
{
  "statusCode": 200,
  "type": "SUCCESS",
  "message": "Успешно",
  "data": {
    "attemptId": "NS7gSQGA2JwwbLVTPwHY1",
    "lang": "ru",
    "fullUrl": "https://faceid-back.theable.tech/public/NS7gSQGA2JwwbLVTPwHY1?lang=ru",
    "redirect": "/check/redirect/NS7gSQGA2JwwbLVTPwHY1"
  }
}
```

| Поле        | Тип данных | Описание                                    |
|-------------|------------|---------------------------------------------|
| `attemptId` | `string`   | ID сессии AbleID                            |
| `lang`      | `string`   | Язык интерфейса (ru, uz, en)                |
| `fullUrl`   | `string`   | Полный URL для перенаправления пользователя |
| `redirect`  | `string`   | Путь редиректа после завершения сессии      |

> **Важно:** Поле `hash` НЕ возвращается на создании сессии. Оно приходит только на вебхуках.

---

## Настройка редиректов

Для корректной работы системы редиректа после завершения идентификации необходимо настроить статические URL в конфигурации проекта.

> **ВАЖНО:**
>
> 1. **Статические URL:** В конфигурации проекта прописываются **2 статических URL**:
>    - **URL успеха** — страница, куда перенаправляется пользователь при успешной идентификации/верификации
>    - **URL ошибки** — страница, куда перенаправляется пользователь при неуспешном прохождении или ошибке
> 2. **Изменение только через поддержку:** Redirect URL изменяются по запросу в службу поддержки.
> 3. **Динамическое изменение недоступно:** В процессе работы через API изменить или переопределить redirect URL **невозможно**.

### Необходимые редиректы

Для настройки обратитесь к нашей команде поддержки и предоставьте следующие данные:

| Параметр                      | Описание                               | Пример                           |
|-------------------------------|----------------------------------------|----------------------------------|
| `SUCCESS_REDIRECT_URL`        | URL для успешного прохождения          | https://example.com/success      |
| `ERROR_REDIRECT_URL`          | URL для неуспешного прохождения/ошибки | https://example.com/error        |

---

## О параметре `transactionId`

`transactionId` — это уникальный идентификатор транзакции, который генерируется на **стороне клиента** (вашего backend-сервера) для отслеживания и связывания запросов.

### Назначение

- **Идентификация запроса:** Позволяет связать сессию AbleID с вашей внутренней транзакцией или операцией
- **Отслеживание:** Используется для логирования и отладки
- **Связывание данных:** Возвращается в webhook-уведомлениях для сопоставления результата с исходным запросом

### Требования к `transactionId`

| Параметр         | Описание                                                                   |
|------------------|----------------------------------------------------------------------------|
| **Генерация**    | Генерируется на стороне клиента (ваш backend)                              |
| **Уникальность** | Должен быть уникальным для каждой новой сессии                             |
| **Формат**       | Строка, рекомендуется использовать UUID или уникальный ID из вашей системы |
| **Длина**        | До 100 символов                                                            |

> **Важно:** Не используйте один и тот же `transactionId` для разных сессий. Каждая новая попытка идентификации должна иметь уникальный `transactionId`.

---

## О параметре `hooks`

Параметр `hooks` — это массив URL-адресов, на которые AbleID отправляет webhook-уведомления о результате сессии идентификации/верификации.

### Как работает

```json
{
  "hooks": [
    "https://your-domain.com/webhook/ableid",
    "https://backup-domain.com/webhook/ableid"
  ]
}
```

### Особенности работы с `hooks`

| Параметр              | Описание                                                                          |
|-----------------------|-----------------------------------------------------------------------------------|
| **Множественные URL** | Можно указать несколько URL. Уведомление отправляется на **ВСЕ** указанные адреса |
| **Формат**            | Массив строк с валидными HTTPS URL                                                |
| **Обязательность**    | Обязательный параметр при создании сессии                                         |
| **Retry политика**    | При ошибке доставки выполняется до **3 повторных попыток** с интервалом 5 секунд  |
| **Таймаут**           | Ожидание ответа от webhook — **10 секунд**                                        |
| **Метод отправки**    | POST запрос с JSON payload                                                        |
| **Заголовки**         | `Content-Type: application/json`                                                  |

### Требования к webhook endpoint

Ваш webhook endpoint должен:
- Принимать POST запросы с JSON payload
- Возвращать HTTP статус 200-299 для подтверждения получения
- Отвечать в течение 10 секунд
- Быть доступным по HTTPS (HTTP не поддерживается для production)

> **Важно:** Webhook отправляются **ТОЛЬКО** при завершении сессии (успешной или неуспешной)

---

## О поле `hash`

Поле `hash` — это код верификации, который используется для проверки подлинности запросов от AbleID.

### Где используется `hash`:

**В вебхуках** — отправляется на ваш сервер для верификации после завершения идентификации:

```json
{
  "statusCode": 200,
  "type": "SUCCESS",
  "message": "Успешно",
  "data": {
    "hash": "1BF41318DFA700936EC613BB8711DC4C68B23C7F",
    "attemptId": "3HQVkBm_zCZqKFbTWVrhf",
    "transactionId": "your-transaction-id",
    "data": {}
  }
}
```

### Как генерируется `hash`:

```javascript
sha1(sha1(projectId + secret).toUpperCase() + attemptId).toUpperCase()
```

### Как проверить `hash`:

При получении запроса от AbleID (например, на вебхук), вы должны проверить подлинность, пересчитав hash:

```javascript
const calculatedHash = sha1(
  sha1(projectId + secret).toUpperCase() + attemptId
).toUpperCase();

if (calculatedHash === receivedHash) {
  // Запрос подлинный
} else {
  // Запрос подделан
}
```

---
